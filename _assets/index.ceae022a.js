import{T as g,b as c,h as S}from"./index.9d64fe28.js";import{y as n,k as j,f as l,d as b,e as f,b as C,n as v,A as I,h as U}from"./vendor.3f06c700.js";import{a as N,d as z,e as F,f as Y,h as A,i as E}from"./locker.4d04012d.js";const M={readText:()=>Promise.reject(),writeText:(e="")=>new Promise((s,r)=>{try{const i=document,t=i.createElement("textarea");t.value=e,i.body.appendChild(t),t.value=e,i.body.appendChild(t),t.select();const a=i.execCommand("copy");i.body.removeChild(t),a?s(!0):r(!1)}catch(i){r(!1)}})};let{clipboard:$=void 0}=navigator;$||($=M);const R=$,V="";var B=Object.defineProperty,G=Object.getOwnPropertyDescriptor,P=(e,s,r,i)=>{for(var t=i>1?void 0:i?G(s,r):s,a=e.length-1,o;a>=0;a--)(o=e[a])&&(t=(i?o(s,r,t):o(t))||t);return i&&t&&B(s,r,t),t};let y=class extends g(V){constructor(){super(...arguments),this.value="",this.copied=!1}firstUpdated(){}async doCopy(){const e=this.value;if(!!e){this.copied=!1;try{await R.writeText(e),this.copied=!0}catch(s){this.copied=!1}}}get icon(){return this.copied?"mdi-check":"mdi-content-copy"}render(){return n`<dui-button sm @click="${this.doCopy}" class="outlined ${j({copied:this.copied})}">${this.copied?n`Copied`:n`Copy`} <i part="copy-icon" class="mdi ${this.icon}"></i></dui-button>`}};P([b()],y.prototype,"value",2);P([l()],y.prototype,"copied",2);y=P([f("dui-copy")],y);const H="";var q=Object.defineProperty,J=Object.getOwnPropertyDescriptor,w=(e,s,r,i)=>{for(var t=i>1?void 0:i?J(s,r):s,a=e.length-1,o;a>=0;a--)(o=e[a])&&(t=(i?o(s,r,t):o(t))||t);return i&&t&&q(s,r,t),t};let d=class extends g(H){constructor(){super(...arguments),this.bindStore=new C(this,c),this.name="",this.limit="0",this.inviteCode="",this.genInviteCode=async()=>{try{let e=await N();e&&(this.inviteCode=e)}catch(e){}}}get bridge(){return c.bridge}get inviteLink(){return`https://lockpass.doid.tech/?ic=${this.inviteCode}`}async connectedCallback(){super.connectedCallback(),this.limit=await z()}get shareText(){return`DOID lock name event is live. Mint your lock pass NFT for free and reserve your desired name now. Get invitation here: ${this.inviteLink}`}render(){return n`<p class="text-sm text-gray-500">You have <b>${this.limit}</b> invitations in total. Copy the invitation code or share the link.</p><div class="py-2">${this.inviteCode?n`<textarea class="block w-full h-24 my-3 border border-solid border-gray-200 py-2 px-2 text-gray-400" readonly="readonly">
${this.shareText}</textarea><dui-copy value="${this.shareText}"></dui-copy>`:+this.limit>0?n`<dui-button sm @click="${this.genInviteCode}">Share</dui-button>`:n``}</div>`}};w([b()],d.prototype,"name",2);w([l()],d.prototype,"limit",2);w([l()],d.prototype,"inviteCode",2);d=w([f("pass-share")],d);const K=`:root{--posterSize: 90px}.pass{position:relative;min-height:8.5rem;display:flex;gap:1rem;border-width:1px;--tw-border-opacity: 1;border-color:rgba(209,213,219,var(--tw-border-opacity));padding:1rem}.pass .poster{margin-bottom:1rem;width:90px;width:var(--posterSize);height:90px;height:var(--posterSize)}.pass .poster:not(.minted){--tw-bg-opacity: 1;background-color:rgba(243,244,246,var(--tw-bg-opacity))}.pass .name.locked{font-size:1rem;line-height:1.5rem}.pass .status.locked{--tw-text-opacity: 1;color:rgba(22,163,74,var(--tw-text-opacity))}.pass .status.unlock{--tw-text-opacity: 1;color:rgba(107,114,128,var(--tw-text-opacity))}.pass .status.minted{--tw-text-opacity: 1;color:rgba(96,165,250,var(--tw-text-opacity))}
`;var Q=Object.defineProperty,W=Object.getOwnPropertyDescriptor,x=(e,s,r,i)=>{for(var t=i>1?void 0:i?W(s,r):s,a=e.length-1,o;a>=0;a--)(o=e[a])&&(t=(i?o(s,r,t):o(t))||t);return i&&t&&Q(s,r,t),t};let h=class extends g(K){constructor(){super(...arguments),this.bindStore=new C(this,c),this.item={},this.tx=null,this.success=!1}get bridge(){return c.bridge}get scan(){return this.bridge.network.current.scan}get tokenLink(){return`${this.scan}/token/${S("Locker")}?a=${this.item.id}`}firstUpdate(){}render(){let e="",s="";return this.item.name?(e="locked",s="Locked"):(e="unlock",s="No name locked yet"),n`<div class="pass"><div class="poster ${j({minted:this.item.meta.image})}"><img src="${this.item.meta.image}" class="object-contain"></div><div class="flex flex-col justify-between text-xs"><div><span class="text-base">#${this.item.id}</span><p><dui-link class="text-black uri" href="${this.tokenLink}" target="_blank">View on etherscan</dui-link></p></div><div><div class="status ${e}">${s}</div>${v(this.item.name,()=>n`<div class="name ${e}"><b class="text-blue-600">${this.item.name}</b>.doid</div>`,()=>n`<div class="actions mt-2"><dui-button href="/?pid=${this.item.id}" sm>Lock a name</dui-button></div>`)}</div></div></div>`}};x([b({type:Object})],h.prototype,"item",2);x([l()],h.prototype,"tx",2);x([l()],h.prototype,"success",2);h=x([f("pass-item")],h);const X=`.Passes{height:300px;height:100%;--tw-bg-opacity: 1;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.pass-list{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));grid-gap:1rem;gap:1rem}@media (min-width: 1024px){.pass-list{grid-template-columns:repeat(2,minmax(0,1fr))}}
`;var Z=Object.defineProperty,tt=Object.getOwnPropertyDescriptor,m=(e,s,r,i)=>{for(var t=i>1?void 0:i?tt(s,r):s,a=e.length-1,o;a>=0;a--)(o=e[a])&&(t=(i?o(s,r,t):o(t))||t);return i&&t&&Z(s,r,t),t};let p=class extends g(X){constructor(){super(...arguments),this.bindStore=new C(this,c),this.name="",this.passes=[],this.pending=!1,this.ts=0}get bridge(){return c.bridge}async getUserPassList(){if(c.notReady)return;this.pending=!0;const{account:e}=c.bridge,s=await F();try{const r=await Y(e,!0),i=await A();let t=await Promise.all(r.map(async a=>{var L;const[o,T,_]=a,k=I(o,0),O=(L=i[T])!=null?L:[],u={id:k,cate:O[0],hash:_,meta:{}},D=await Promise.all([E(_),s.tokenURI(k)]);u.name=D[0],u.len=`${O[1]}`;try{u.meta=await(await fetch(D[1])).json()}catch(et){}return u}));this.passes=t.sort((a,o)=>a.id-o.id).sort((a,o)=>a.name?o.name?a.id-o.id:-1:1)}catch(r){console.log(r,"get passess failed"),this.passes=[]}finally{this.ts++,this.pending=!1}}get empty(){return this.ts&&!this.passes.length}connectedCallback(){super.connectedCallback(),this.getUserPassList()}render(){return n`<div class="passes py-4"><div class="lg_w-3/5 my-8 mx-3 lg_mx-auto"><section><p class="text-base mb-2">Note</p><ul class="note list-disc mx-4"><li>You can only mint one Lock Pass for one wallet address.</li><li>Once you successfully locked your name. Your name will be reserved for 7 days after the official launch(22nd Dec,2022). Those locked but unminted names will be released to the public pool afterwards.</li></ul><a href="${"https://twitter.com/DoidFoundation"}" target="_blank" rel="noopener" class="uri inline-flex my-2 text-base">Follow DOID Twitter and stay connected</a></section>${v(c.noAccount,()=>n`<div class="my-8 text-center"><connect-wallet-btn></connect-wallet-btn></div>`,()=>n`<section class="mt-6"><h2 class="my-4 text-xl">My Lock Pass</h2><div class="py-4">${v(this.empty,()=>n`No passes yet.`,()=>n`${v(this.pending,()=>n`<i class="mdi mdi-loading mr-1"></i>Loading...`,()=>n`<div class="pass-list">${U(this.passes,e=>n`<pass-item key="${e.id}" .item="${e}"></pass-item>`)}</div>`)}`)}</div></section><section class="mt-6"><h2 class="text-xl mb-2">Share Lock Pass Invitations</h2>${this.passes.length?n`<pass-share></pass-share>`:n``}</section>`)}</div></div>`}};m([b()],p.prototype,"name",2);m([l()],p.prototype,"passes",2);m([l()],p.prototype,"pending",2);m([l()],p.prototype,"ts",2);p=m([f("view-passes")],p);export{p as ViewPasses};
