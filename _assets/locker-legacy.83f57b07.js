System.register(["./vendor-legacy.a2ea4b3a.js","./index-legacy.e7cc960d.js"],(function(e,t){"use strict";var s,a,i,c,r,n,o,h,d,u,l,f,w,g,y,b,p,m;return{setters:[e=>{s=e.p,a=e.S,i=e.w,c=e.q,r=e.x,n=e.z,o=e.A},e=>{h=e.b,d=e.u,u=e.g,l=e.n,f=e.e,w=e._,g=e.a,y=e.c,b=e.Z,p=e.d,m=e.f}],execute:function(){var v=Object.defineProperty,q=Object.getOwnPropertyDescriptor;class x extends a{constructor(e){super(),this.key="",this.key=e}save(){this.queue=[...this.queue],localStorage.setItem(this.key,JSON.stringify(this.queue))}}((e,t,s,a)=>{for(var i,c=a>1?void 0:a?q(t,s):t,r=e.length-1;r>=0;r--)(i=e[r])&&(c=(a?i(t,s,c):i(c))||c);a&&c&&v(t,s,c)})([s({value:[]})],x.prototype,"queue",2);class k{constructor(e){this.provider=d().bridgeStore.bridge.provider,this.store=new x(`evm.txs.${e||this.provider.account}`),this.checking=new Set,this.check(!0)}get queue(){return this.store.queue}async add(e){if(!e.chainId){const{network:t}=this.provider;e.chainId=t.chainId,e.scan=t.scan}e.pending=!0,this.queue.unshift(e),this.store.save(),this.provider.nonce=+e.nonce+1}delDelay(e,t=0){setTimeout((()=>this.del(e)),t)}del(e){const t=e.hash??e.ts??e;this.queue.some(((e,s)=>{if([e.hash,e.ts,e].includes(t)){0===s&&(this.provider.nonce=0);const e=this.queue.splice(s,1);return this.store.save(),e}}))}async check(e){this.queue.forEach((async(t,s)=>{if(e&&0===s){const e=await u(this.provider.account),s=+t.nonce;this.provider.nonce=s>e?s+1:e}if(t.done||(new Date).getTime()-t.ts>=72e5)return this.del(t);if(!t.err&&(e||!t.pending)){t.pending=!0;try{const e=await this.provider.provider.waitForTransaction(t.hash),{status:s}=e;t.status=s,1===s?(t.done=!0,this.del(t)):t.err=!0}catch(a){t.err=a}t.pending=!1}})),this.store.save()}}const j={},S=(e=h.bridge.account)=>j[e]||(j[e]=new k(e));class C{constructor(e,{errorCodes:t="",seq:s,delay:a=0,allowAlmostSuccess:i=!1}={}){this.pending=!0,this.status=-1,this.allowAlmostSuccess=i,this.txPromise=e,this.err=void 0,this.hash="",this.errorCodes=t,this.seq=s,this.delay=a}get success(){return 1===this.status}get almostSuccess(){return 4===this.status}get ignored(){return 3===this.status}async wait(e=!1){return(async()=>{let s=!1;const a=await(async e=>e?"object"==typeof e?e:await w(Object.assign({"./abi/Locker.codes.json":()=>g((()=>t.import("./Locker.codes-legacy.9698cd05.js")),void 0)}),`./abi/${e}.codes.json`):{})(this.errorCodes);try{const t=await this.txPromise,{hash:i,nonce:c}=t;this.seq.nonce=c,this.seq&&(delete this.seq.overrides,S().add(Object.assign(this.seq,{hash:i}))),this.hash=i,this.status=2;const r=async()=>{const{status:e,events:s}=await t.wait(1);if(1!==e)throw this.seq&&(this.seq.err=!0),new Error("Failed");s.some((({event:e,args:t}={})=>{if("Failure"===e){let{info:e,detail:s,error:i}=t;const c=i.toString(),r=a[i],n={code:c,message:r,error:i,info:e?.toString(),detail:s?.toString()};this.seq&&(this.seq.err=!0);const o=new Error(r);throw Object.assign(o,{code:c,raw:n}),this.allowAlmostSuccess&&(this.status=4),o}})),this.status=1,this.seq&&(this.seq.done=!0),this.delay?S().delDelay(i,this.delay):S().del(i)};e?(s=!0,r()):await r()}catch(i){throw await l(i),4001===i.code?this.status=3:4!==this.status&&(this.status=0),this.err=i,i}finally{this.pending=!1;const e=1===this.status;f.emit("tx-status",this.hash),e&&f.emit("tx-success",this.hash),s=e}return s})()}}const I={A:2,B:4,C:6},O=e=>[e,I[e]],P={"0x1":{"0x03783fac2efed8fbc9ad443e592ee30e61d65f471140c10ca155e937b435b760":O("A"),"0x1f675bff07515f5df96737194ea945c36c41e7b4fcef307b7cd4d0e602a69111":O("B"),"0x017e667f4b8c174291d1543c466717566e206df1bfd6f30271055ddafdb18f72":O("C")},"0xaa36a7":{"0x03783fac2efed8fbc9ad443e592ee30e61d65f471140c10ca155e937b435b760":O("A"),"0x1f675bff07515f5df96737194ea945c36c41e7b4fcef307b7cd4d0e602a69111":O("B"),"0x017e667f4b8c174291d1543c466717566e206df1bfd6f30271055ddafdb18f72":O("C")}},L=e("L",[64,130]),A=async()=>(await m()).bridge,B=async e=>e||(await A()).account,N=e("h",(async()=>P[(await A()).network.current.chainId])),D=e("e",(async e=>y("Locker",{account:await B(e)}))),E=e=>e.replace(/^0x/,""),U=e=>L[e.length<L[1]?0:1],T=e=>{e=E(e);const t=U(e);return e.slice(t,t+1).toUpperCase()},F=(e("g",(e=>I[T(e)??"C"]??I.C)),e("a",(async e=>{e||(e=await B(e));const t=i(c("C"));let s="";return s=r(BigInt(e)^BigInt(t)),[s.replace("0x",""),"c","0"].join("")})),e("c",(async e=>{const t=await D();return await t.nameExists(e)})),e("f",(async(e,t=!1)=>{e||(e=await B());const s=await D(e);return await s[t?"getUserPassesInfo":"getUserPassList"](e)})),e("i",(async e=>{let t="";if(!e||e===b)return t;const s=await D();try{t=await s.getNameByHash(n(e))}catch(a){}return t})));e("b",(async(e,t)=>{const s=await D(t),a=await N();let i={id:e,cate:"C",len:6,name:""};try{const[t,c,r]=await s.getUserPassInfo(e),n=a[c]??Object.values(i);i={id:t,cate:n[0],hash:r,len:n[1],name:await F(r)}}catch(c){}return i})),e("l",(async(e,t="")=>{let{id:s,code:a,cate:i}=e;const c=!!s;s||(a=(e=>`0x${(e=E(e)).slice(0,U(e))}`)(e),i=(await(async()=>Object.fromEntries(Object.entries(await N()).map((e=>[e[1][0],e[0]]))))())[T(e)],s=(e=>(e=E(e),parseInt(e.slice(U(e)+1,e.length)||"0",16)))(e));const r=await D(),n=c?"lockName":"lockPass",o={},h=c?[+s,t]:[a,t,i,+s];await p(o,r,n,h);const d=r[n](...h);return new C(d,{errorCodes:"Locker",allowAlmostSuccess:!0,seq:{type:c?"LockName":"lockPass",title:c?"Lock Name":"Lock Pass",ts:(new Date).getTime(),overrides:o}})})),e("d",(async e=>{e||(e=await B());const t=await D(e),s=await t.getUserInvitedNumber(e);return o(s[1],0)}))}}}));
